<template>
  <div class="app-container">
    <el-row>
      <el-col :span="24">
        <SearchArea :vertical="false" />
      </el-col>
    </el-row>
    <div class="content-container">
      <h2 class="table-title">以麒麟/libnotify4为例</h2>
      <div class="info-row">
        <div class="info-container header-container">
          <div class="info-key header-item">上游仓库</div>
          <div class="info-key header-item">上游漏洞描述</div>
          <div class="info-key header-item">触发方式</div>
          <div class="info-key header-item">上游漏洞ID</div>
          <div class="info-key header-item">受影响的下游</div>
        </div>
        <div v-for="(item, index) in tableData" :key="index" class="info-container">
          <div class="info-key">{{ item.library }}</div>
          <div class="info-key">{{ item.description }}</div>
          <div class="info-key">{{ item.trigger }}</div>
          <div class="info-key">{{ item.cve }}</div>
          <div class="info-key">{{ item.downstream }}</div>
        </div>
      </div>
    </div>
  </div>
</template>



<script lang="ts" setup>
import { ref } from 'vue';
import SearchArea from '@/components/SearchArea.vue';

interface TableData {
  library: string;
  description: string;
  trigger: string;
  cve: string;
  downstream: string;
}

const tableData = ref<TableData[]>([
  {
    library: 'libheif',
    description: 'libheif被发现通过函数UncompressedImageCodec:: decode_uncompressed_image 存在段违规。',
    trigger: '不修改PoC直接触发',
    cve: 'CVE-2023-49460',
    downstream: 'jasper',
  },
  {
    library: 'libavif',
    description: 'Google Chrome 浏览器中 libavif 的 Free 后使用允许远程攻击者通过制作的 avif 文件利用堆破坏。',
    trigger: '不修改PoC直接触发',
    cve: 'CVE-2023-6350',
    downstream: 'libgd',
  },
  {
    library: 'libjpeg-turbo',
    description: 'libjpeg-turbo在 jdcoefct.c 中的 decompress_smooth_data 中存在基于堆的缓冲区超读。',
    trigger: '不修改PoC直接触发',
    cve: 'CVE-2021-29390',
    downstream: 'Imagemagick',
  },
  {
    library: 'libjxl',
    description: '使用 libjxl 的无效 JPEG XL 图像会在渲染花键时导致对 std::vector<std::vector<T>> 的越界访问。OOB 读取访问可能导致分区故障，或基于其他进程内存渲染样条。',
    trigger: '不修改PoC直接触发',
    cve: 'CVE-2021-22563',
    downstream: 'libvips',
  },
  {
    library: 'libtiff',
    description: 'tif_dirread.c 中 TIFFReadDirectory() 的 memcpy() 函数作为参数传递的源代码指针为空，可能导致通过伪造的 TIFF 文件拒绝服务。',
    trigger: '直接触发',
    cve: 'CVE-2022-0562',
    downstream: 'libwebp',
  },
]);
</script>

<style scoped>
.app-container {
  width: 100%;
  box-sizing: border-box;
  background-image: url('/Exploitability_back.png');
  background-size: cover;
  background-repeat: no-repeat;
  min-height: 100vh;
  padding: 20px;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 20px;
}

.table-title {
  font-size: 24px;
  color: #ffffff;
  margin-bottom: 20px;
  text-align: center;
}

.content-container {
  background: rgba(0, 0, 0, 0.7); /* 统一透明度 */
  border-radius: 10px;
  padding: 30px;
  max-width: 1600px;
  width: 100%;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
}

.info-row {
  display: flex;
  flex-direction: column;
}

.info-container {
  display: flex;
  justify-content: space-between;
  gap: 10px;
  padding: 10px;
}

.info-key {
  color: #ffffff;
  font-weight: bold; /* 第一行和第一列加粗 */
  flex: 1;
  text-align: left;
  padding: 10px;
  border-bottom: 1px solid rgba(255, 255, 255, 0.2);
}

.header-container {
  background: rgba(0, 0, 0, 0.5); /* 统一透明度 */
  border-radius: 5px;
}

.info-cell {
  background-color: rgba(0, 0, 0, 0.3); /* 统一透明度 */
  color: #ffffff;
  flex: 1;
  text-align: left;
  padding: 10px;
  border-bottom: 1px solid rgba(255, 255, 255, 0.3); /* 保持底部边框和背景风格一致 */
  font-weight: normal; /* 其他行不加粗 */
}

.info-row:last-child .info-cell {
  border-bottom: none;
}
</style>

